{"ast":null,"code":"import React,{createContext,useContext,useState,useEffect}from'react';import{useNavigate,useLocation}from'react-router-dom';import{setAuthToken}from'../api';import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext(null);export function AuthProvider(_ref){let{children}=_ref;// Initialize token from localStorage to persist login across page refreshes\nconst[token,setToken]=useState(()=>localStorage.getItem('authToken'));const navigate=useNavigate();const location=useLocation();// This effect synchronizes the token with localStorage and the api client header\nuseEffect(()=>{if(token){localStorage.setItem('authToken',token);setAuthToken(token);}else{localStorage.removeItem('authToken');setAuthToken(null);}},[token]);const login=newToken=>{var _location$state,_location$state$from;setToken(newToken);// Redirect user to the page they were trying to access, or to the homepage\nconst from=((_location$state=location.state)===null||_location$state===void 0?void 0:(_location$state$from=_location$state.from)===null||_location$state$from===void 0?void 0:_location$state$from.pathname)||'/';navigate(from,{replace:true});};const logout=()=>{setToken(null);navigate('/login');};const value={token,login,logout};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:value,children:children});}export function useAuth(){return useContext(AuthContext);}","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","useNavigate","useLocation","setAuthToken","jsx","_jsx","AuthContext","AuthProvider","_ref","children","token","setToken","localStorage","getItem","navigate","location","setItem","removeItem","login","newToken","_location$state","_location$state$from","from","state","pathname","replace","logout","value","Provider","useAuth"],"sources":["/home/demon/distributed-architecture/central-infrastructure/frontend/src/auth/AuthContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport { setAuthToken } from '../api';\n\nconst AuthContext = createContext(null);\n\nexport function AuthProvider({ children }) {\n  // Initialize token from localStorage to persist login across page refreshes\n  const [token, setToken] = useState(() => localStorage.getItem('authToken'));\n  const navigate = useNavigate();\n  const location = useLocation();\n\n  // This effect synchronizes the token with localStorage and the api client header\n  useEffect(() => {\n    if (token) {\n      localStorage.setItem('authToken', token);\n      setAuthToken(token);\n    } else {\n      localStorage.removeItem('authToken');\n      setAuthToken(null);\n    }\n  }, [token]);\n\n  const login = (newToken) => {\n    setToken(newToken);\n    // Redirect user to the page they were trying to access, or to the homepage\n    const from = location.state?.from?.pathname || '/';\n    navigate(from, { replace: true });\n  };\n\n  const logout = () => {\n    setToken(null);\n    navigate('/login');\n  };\n\n  const value = { token, login, logout };\n\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\n}\n\nexport function useAuth() {\n  return useContext(AuthContext);\n}"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,aAAa,CAAEC,UAAU,CAAEC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAC7E,OAASC,WAAW,CAAEC,WAAW,KAAQ,kBAAkB,CAC3D,OAASC,YAAY,KAAQ,QAAQ,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAEtC,KAAM,CAAAC,WAAW,cAAGT,aAAa,CAAC,IAAI,CAAC,CAEvC,MAAO,SAAS,CAAAU,YAAYA,CAAAC,IAAA,CAAe,IAAd,CAAEC,QAAS,CAAC,CAAAD,IAAA,CACvC;AACA,KAAM,CAACE,KAAK,CAAEC,QAAQ,CAAC,CAAGZ,QAAQ,CAAC,IAAMa,YAAY,CAACC,OAAO,CAAC,WAAW,CAAC,CAAC,CAC3E,KAAM,CAAAC,QAAQ,CAAGb,WAAW,CAAC,CAAC,CAC9B,KAAM,CAAAc,QAAQ,CAAGb,WAAW,CAAC,CAAC,CAE9B;AACAF,SAAS,CAAC,IAAM,CACd,GAAIU,KAAK,CAAE,CACTE,YAAY,CAACI,OAAO,CAAC,WAAW,CAAEN,KAAK,CAAC,CACxCP,YAAY,CAACO,KAAK,CAAC,CACrB,CAAC,IAAM,CACLE,YAAY,CAACK,UAAU,CAAC,WAAW,CAAC,CACpCd,YAAY,CAAC,IAAI,CAAC,CACpB,CACF,CAAC,CAAE,CAACO,KAAK,CAAC,CAAC,CAEX,KAAM,CAAAQ,KAAK,CAAIC,QAAQ,EAAK,KAAAC,eAAA,CAAAC,oBAAA,CAC1BV,QAAQ,CAACQ,QAAQ,CAAC,CAClB;AACA,KAAM,CAAAG,IAAI,CAAG,EAAAF,eAAA,CAAAL,QAAQ,CAACQ,KAAK,UAAAH,eAAA,kBAAAC,oBAAA,CAAdD,eAAA,CAAgBE,IAAI,UAAAD,oBAAA,iBAApBA,oBAAA,CAAsBG,QAAQ,GAAI,GAAG,CAClDV,QAAQ,CAACQ,IAAI,CAAE,CAAEG,OAAO,CAAE,IAAK,CAAC,CAAC,CACnC,CAAC,CAED,KAAM,CAAAC,MAAM,CAAGA,CAAA,GAAM,CACnBf,QAAQ,CAAC,IAAI,CAAC,CACdG,QAAQ,CAAC,QAAQ,CAAC,CACpB,CAAC,CAED,KAAM,CAAAa,KAAK,CAAG,CAAEjB,KAAK,CAAEQ,KAAK,CAAEQ,MAAO,CAAC,CAEtC,mBAAOrB,IAAA,CAACC,WAAW,CAACsB,QAAQ,EAACD,KAAK,CAAEA,KAAM,CAAAlB,QAAA,CAAEA,QAAQ,CAAuB,CAAC,CAC9E,CAEA,MAAO,SAAS,CAAAoB,OAAOA,CAAA,CAAG,CACxB,MAAO,CAAA/B,UAAU,CAACQ,WAAW,CAAC,CAChC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}