{"ast":null,"code":"var _jsxFileName = \"/home/demon/distributed-architecture/central-infrastructure/frontend/src/pages/Threats.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { useLocation, useNavigate } from 'react-router-dom';\nimport ThreatFilters from '../components/threats/ThreatFilters';\nimport ThreatTable from '../components/threats/ThreatTable';\nimport ThreatTabs from '../components/threats/ThreatTabs';\nimport EnhancedFilters from '../components/EnhancedFilters';\nimport { fetchThreatFeed, fetchScanAlerts, fetchDeceptionActivity, fetchEvents, fetchCombinedThreatData } from '../api';\nimport { combineAndSortEvents, calculateThreatStats, normalizeEvent, exportEventsToCSV } from '../utils/dataProcessor';\nimport './Threats.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Threats = () => {\n  _s();\n  const location = useLocation();\n  const navigate = useNavigate();\n\n  // Local state for controls (previously from GlobalControls)\n  const [timeRange, setTimeRange] = useState('24h');\n  const [selectedClient, setSelectedClient] = useState('all');\n  const [lastUpdated, setLastUpdated] = useState(new Date());\n  const [activeTab, setActiveTab] = useState('alerts');\n  const [threats, setThreats] = useState([]);\n  const [allEvents, setAllEvents] = useState([]);\n  const [filteredEvents, setFilteredEvents] = useState([]);\n  const [threatStats, setThreatStats] = useState({});\n  const [loading, setLoading] = useState(true);\n  const [useEnhancedFilters, setUseEnhancedFilters] = useState(true);\n  const [filters, setFilters] = useState({\n    severity: 'all',\n    platform: 'all',\n    status: 'all',\n    search: ''\n  });\n  const [savedViews, setSavedViews] = useState([{\n    name: 'Critical Threats',\n    filters: {\n      severity: 'critical'\n    }\n  }, {\n    name: 'Network Attacks',\n    filters: {\n      platform: 'network'\n    }\n  }, {\n    name: 'Deception Engine Activity',\n    filters: {\n      platform: 'honeypot'\n    }\n  }]);\n  const loadThreats = useCallback(async () => {\n    try {\n      setLoading(true);\n\n      // Use enhanced multi-collection data fetching\n      // Convert timeRange string to hours number for API compatibility\n      const hours = timeRange === '1h' ? 1 : timeRange === '6h' ? 6 : timeRange === '12h' ? 12 : timeRange === '24h' ? 24 : timeRange === '7d' ? 168 : 24;\n      const combinedData = await fetchCombinedThreatData({\n        limit: 500,\n        hours: hours\n      });\n      if (combinedData && (combinedData.scanAlerts || combinedData.deceptionActivity)) {\n        // Combine and normalize all events\n        const allEventsData = combineAndSortEvents({\n          scan_alerts: combinedData.scanAlerts || [],\n          deception_detection: combinedData.deceptionActivity || []\n        });\n        setAllEvents(allEventsData);\n        setFilteredEvents(allEventsData);\n        setThreatStats(calculateThreatStats(allEventsData));\n\n        // Convert to legacy threat format for backward compatibility\n        const legacyThreats = allEventsData.map(event => ({\n          ...event,\n          id: event.id || `event-${Math.random()}`,\n          type: event.collection === 'scan_alerts' ? 'scan_detection' : 'deception_engine',\n          platform: event.collection === 'scan_alerts' ? 'Scan_Detection_Engine' : 'Deception_Engine',\n          severity: event.severity || 'medium',\n          timestamp: new Date(event.timestamp || Date.now()),\n          source: event.source_ip,\n          target: event.dest_port || event.honeypot_id,\n          status: 'new',\n          message: event.message,\n          alertType: event.note_type || event.event_type\n        }));\n        setThreats(legacyThreats);\n\n        // Log any errors from data fetching\n        if (combinedData.errors && combinedData.errors.length > 0) {\n          console.warn('Data fetching warnings:', combinedData.errors);\n        }\n      } else {\n        // Fallback to individual API calls\n        console.warn('Using fallback data fetching method');\n        const [threatData, scanData, deceptionData] = await Promise.all([fetchThreatFeed(500).catch(() => []), fetchScanAlerts({\n          hours: hours,\n          limit: 200\n        }).catch(() => []), fetchDeceptionActivity({\n          hours: hours,\n          limit: 200\n        }).catch(() => [])]);\n\n        // Normalize and combine data\n        const normalizedEvents = [...(Array.isArray(threatData) ? threatData : []).map(t => normalizeEvent(t, 'scan_alerts')), ...(Array.isArray(scanData) ? scanData : []).map(z => normalizeEvent(z, 'scan_alerts')), ...(Array.isArray(deceptionData) ? deceptionData : []).map(e => normalizeEvent(e, 'deception_detection'))];\n        setAllEvents(normalizedEvents);\n        setFilteredEvents(normalizedEvents);\n        setThreatStats(calculateThreatStats(normalizedEvents));\n\n        // Legacy format\n        const legacyThreats = normalizedEvents.map(event => ({\n          ...event,\n          type: event.collection === 'scan_alerts' ? 'scan_detection' : 'deception_engine',\n          platform: event.collection === 'scan_alerts' ? 'Scan_Detection_Engine' : 'Deception_Engine',\n          timestamp: new Date(event.timestamp || Date.now()),\n          source: event.source_ip,\n          target: event.dest_port || event.honeypot_id,\n          status: 'new',\n          message: event.message,\n          alertType: event.note_type || event.event_type\n        }));\n        setThreats(legacyThreats);\n      }\n    } catch (error) {\n      console.error('Error loading threats:', error);\n    } finally {\n      setLoading(false);\n      setLastUpdated(new Date());\n    }\n  }, [timeRange]);\n  useEffect(() => {\n    loadThreats();\n  }, [timeRange, selectedClient]);\n\n  // Handle tab changes from URL\n  useEffect(() => {\n    const path = location.pathname;\n    if (path.includes('/alerts')) setActiveTab('alerts');else if (path.includes('/iocs')) setActiveTab('iocs');else if (path.includes('/ttps')) setActiveTab('ttps');else if (path.includes('/campaigns')) setActiveTab('campaigns');\n  }, [location.pathname]);\n  const handleTabChange = tab => {\n    setActiveTab(tab);\n    navigate(`/threats/${tab}`);\n  };\n  const handleFilterChange = newFilters => {\n    setFilters({\n      ...filters,\n      ...newFilters\n    });\n  };\n  const applyFilters = items => {\n    return items.filter(item => {\n      if (filters.severity !== 'all' && item.severity !== filters.severity) return false;\n      if (filters.platform !== 'all' && item.platform !== filters.platform) return false;\n      if (filters.status !== 'all' && item.status !== filters.status) return false;\n      if (filters.search) {\n        const search = filters.search.toLowerCase();\n        return item.source && item.source.toLowerCase().includes(search) || item.target && item.target.toLowerCase().includes(search) || item.message && item.message.toLowerCase().includes(search) || item.alertType && item.alertType.toLowerCase().includes(search);\n      }\n      return true;\n    });\n  };\n  const filteredThreats = applyFilters(threats);\n  const handleThreatClick = threat => {\n    navigate(`/threats/alerts/${threat.id}`);\n  };\n  const handleExport = () => {\n    try {\n      const dataToExport = useEnhancedFilters ? filteredEvents : applyFilters(threats);\n      const csvContent = exportEventsToCSV(dataToExport);\n\n      // Create and download CSV file\n      const blob = new Blob([csvContent], {\n        type: 'text/csv;charset=utf-8;'\n      });\n      const link = document.createElement('a');\n      const url = URL.createObjectURL(blob);\n      link.setAttribute('href', url);\n      link.setAttribute('download', `threats_export_${new Date().toISOString().slice(0, 10)}.csv`);\n      link.style.visibility = 'hidden';\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n    } catch (error) {\n      console.error('Error exporting threats:', error);\n    }\n  };\n\n  // Enhanced filter change handler\n  const handleEnhancedFilterChange = useCallback(filtered => {\n    setFilteredEvents(filtered);\n  }, []);\n  const handleSaveView = name => {\n    setSavedViews([...savedViews, {\n      name,\n      filters: {\n        ...filters\n      }\n    }]);\n  };\n  const handleLoadView = view => {\n    setFilters({\n      ...filters,\n      ...view.filters\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"threats-page\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"page-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"header-content\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"Threat Intelligence\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 226,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Monitor, analyze, and respond to security threats\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"header-actions\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: `btn ${useEnhancedFilters ? 'btn-primary' : 'btn-secondary'}`,\n          onClick: () => setUseEnhancedFilters(!useEnhancedFilters),\n          children: [\"\\uD83D\\uDD27 \", useEnhancedFilters ? 'Enhanced' : 'Basic', \" Filters\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 230,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn btn-secondary\",\n          onClick: handleExport,\n          children: [\"\\uD83D\\uDCCA Export (\", useEnhancedFilters ? filteredEvents.length : applyFilters(threats).length, \")\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn btn-primary\",\n          onClick: loadThreats,\n          children: \"\\uD83D\\uDD04 Refresh\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 239,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ThreatTabs, {\n      activeTab: activeTab,\n      onTabChange: handleTabChange\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"threats-content\",\n      children: [useEnhancedFilters ? /*#__PURE__*/_jsxDEV(EnhancedFilters, {\n        events: allEvents,\n        onFilterChange: handleEnhancedFilterChange,\n        loading: loading,\n        className: \"threats-enhanced-filters\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(ThreatFilters, {\n        filters: filters,\n        onFilterChange: handleFilterChange,\n        savedViews: savedViews,\n        onSaveView: handleSaveView,\n        onLoadView: handleLoadView,\n        resultCount: filteredThreats.length\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"threats-main\",\n        children: [activeTab === 'alerts' && /*#__PURE__*/_jsxDEV(ThreatTable, {\n          threats: useEnhancedFilters ? filteredEvents.map(event => ({\n            ...event,\n            id: event.id || `event-${Math.random()}`,\n            type: event.collection === 'scan_alerts' ? 'scan_detection' : 'deception_engine',\n            platform: event.collection === 'scan_alerts' ? 'Scan_Detection_Engine' : 'Deception_Engine',\n            severity: event.severity || 'medium',\n            timestamp: new Date(event.timestamp || Date.now()),\n            source: event.source_ip,\n            target: event.dest_port || event.honeypot_id,\n            status: 'new',\n            message: event.message,\n            alertType: event.note_type || event.event_type\n          })) : filteredThreats,\n          loading: loading,\n          onThreatClick: handleThreatClick\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 268,\n          columnNumber: 13\n        }, this), activeTab === 'iocs' && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"tab-content\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"IOC Analysis\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 289,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Indicators of Compromise extracted from threat data\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 290,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 288,\n          columnNumber: 13\n        }, this), activeTab === 'ttps' && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"tab-content\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"TTP Analysis\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 296,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Tactics, Techniques, and Procedures identified\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 297,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 295,\n          columnNumber: 13\n        }, this), activeTab === 'campaigns' && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"tab-content\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Campaign Analysis\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 303,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Correlated attack campaigns and threat actors\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 304,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 302,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 266,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 247,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 223,\n    columnNumber: 5\n  }, this);\n};\n_s(Threats, \"GYGH813+JoTdAmV1ZqvHfGBHxSE=\", false, function () {\n  return [useLocation, useNavigate];\n});\n_c = Threats;\nexport default Threats;\nvar _c;\n$RefreshReg$(_c, \"Threats\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","useLocation","useNavigate","ThreatFilters","ThreatTable","ThreatTabs","EnhancedFilters","fetchThreatFeed","fetchScanAlerts","fetchDeceptionActivity","fetchEvents","fetchCombinedThreatData","combineAndSortEvents","calculateThreatStats","normalizeEvent","exportEventsToCSV","jsxDEV","_jsxDEV","Threats","_s","location","navigate","timeRange","setTimeRange","selectedClient","setSelectedClient","lastUpdated","setLastUpdated","Date","activeTab","setActiveTab","threats","setThreats","allEvents","setAllEvents","filteredEvents","setFilteredEvents","threatStats","setThreatStats","loading","setLoading","useEnhancedFilters","setUseEnhancedFilters","filters","setFilters","severity","platform","status","search","savedViews","setSavedViews","name","loadThreats","hours","combinedData","limit","scanAlerts","deceptionActivity","allEventsData","scan_alerts","deception_detection","legacyThreats","map","event","id","Math","random","type","collection","timestamp","now","source","source_ip","target","dest_port","honeypot_id","message","alertType","note_type","event_type","errors","length","console","warn","threatData","scanData","deceptionData","Promise","all","catch","normalizedEvents","Array","isArray","t","z","e","error","path","pathname","includes","handleTabChange","tab","handleFilterChange","newFilters","applyFilters","items","filter","item","toLowerCase","filteredThreats","handleThreatClick","threat","handleExport","dataToExport","csvContent","blob","Blob","link","document","createElement","url","URL","createObjectURL","setAttribute","toISOString","slice","style","visibility","body","appendChild","click","removeChild","handleEnhancedFilterChange","filtered","handleSaveView","handleLoadView","view","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","onTabChange","events","onFilterChange","onSaveView","onLoadView","resultCount","onThreatClick","_c","$RefreshReg$"],"sources":["/home/demon/distributed-architecture/central-infrastructure/frontend/src/pages/Threats.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport { useLocation, useNavigate } from 'react-router-dom';\n\nimport ThreatFilters from '../components/threats/ThreatFilters';\nimport ThreatTable from '../components/threats/ThreatTable';\nimport ThreatTabs from '../components/threats/ThreatTabs';\nimport EnhancedFilters from '../components/EnhancedFilters';\nimport { \n  fetchThreatFeed, \n  fetchScanAlerts,\n  fetchDeceptionActivity,\n  fetchEvents,\n  fetchCombinedThreatData\n} from '../api';\nimport { \n  combineAndSortEvents, \n  calculateThreatStats,\n  normalizeEvent,\n  exportEventsToCSV\n} from '../utils/dataProcessor';\nimport './Threats.css';\n\nconst Threats = () => {\n  const location = useLocation();\n  const navigate = useNavigate();\n  \n  // Local state for controls (previously from GlobalControls)\n  const [timeRange, setTimeRange] = useState('24h');\n  const [selectedClient, setSelectedClient] = useState('all');\n  const [lastUpdated, setLastUpdated] = useState(new Date());\n  \n  const [activeTab, setActiveTab] = useState('alerts');\n  const [threats, setThreats] = useState([]);\n  const [allEvents, setAllEvents] = useState([]);\n  const [filteredEvents, setFilteredEvents] = useState([]);\n  const [threatStats, setThreatStats] = useState({});\n  const [loading, setLoading] = useState(true);\n  const [useEnhancedFilters, setUseEnhancedFilters] = useState(true);\n  const [filters, setFilters] = useState({\n    severity: 'all',\n    platform: 'all',\n    status: 'all',\n    search: ''\n  });\n  const [savedViews, setSavedViews] = useState([\n    { name: 'Critical Threats', filters: { severity: 'critical' } },\n    { name: 'Network Attacks', filters: { platform: 'network' } },\n    { name: 'Deception Engine Activity', filters: { platform: 'honeypot' } }\n  ]);\n\n  const loadThreats = useCallback(async () => {\n    try {\n      setLoading(true);\n      \n      // Use enhanced multi-collection data fetching\n      // Convert timeRange string to hours number for API compatibility\n      const hours = timeRange === '1h' ? 1 : \n                   timeRange === '6h' ? 6 : \n                   timeRange === '12h' ? 12 : \n                   timeRange === '24h' ? 24 : \n                   timeRange === '7d' ? 168 : 24;\n      \n      const combinedData = await fetchCombinedThreatData({ \n        limit: 500,\n        hours: hours \n      });\n\n      if (combinedData && (combinedData.scanAlerts || combinedData.deceptionActivity)) {\n        // Combine and normalize all events\n        const allEventsData = combineAndSortEvents({\n          scan_alerts: combinedData.scanAlerts || [],\n          deception_detection: combinedData.deceptionActivity || []\n        });\n\n        setAllEvents(allEventsData);\n        setFilteredEvents(allEventsData);\n        setThreatStats(calculateThreatStats(allEventsData));\n\n        // Convert to legacy threat format for backward compatibility\n        const legacyThreats = allEventsData.map(event => ({\n          ...event,\n          id: event.id || `event-${Math.random()}`,\n          type: event.collection === 'scan_alerts' ? 'scan_detection' : 'deception_engine',\n          platform: event.collection === 'scan_alerts' ? 'Scan_Detection_Engine' : 'Deception_Engine',\n          severity: event.severity || 'medium',\n          timestamp: new Date(event.timestamp || Date.now()),\n          source: event.source_ip,\n          target: event.dest_port || event.honeypot_id,\n          status: 'new',\n          message: event.message,\n          alertType: event.note_type || event.event_type\n        }));\n\n        setThreats(legacyThreats);\n\n        // Log any errors from data fetching\n        if (combinedData.errors && combinedData.errors.length > 0) {\n          console.warn('Data fetching warnings:', combinedData.errors);\n        }\n      } else {\n        // Fallback to individual API calls\n        console.warn('Using fallback data fetching method');\n        const [threatData, scanData, deceptionData] = await Promise.all([\n          fetchThreatFeed(500).catch(() => []),\n          fetchScanAlerts({ hours: hours, limit: 200 }).catch(() => []),\n          fetchDeceptionActivity({ hours: hours, limit: 200 }).catch(() => [])\n        ]);\n\n        // Normalize and combine data\n        const normalizedEvents = [\n          ...(Array.isArray(threatData) ? threatData : []).map(t => normalizeEvent(t, 'scan_alerts')),\n          ...(Array.isArray(scanData) ? scanData : []).map(z => normalizeEvent(z, 'scan_alerts')),\n          ...(Array.isArray(deceptionData) ? deceptionData : []).map(e => normalizeEvent(e, 'deception_detection'))\n        ];\n\n        setAllEvents(normalizedEvents);\n        setFilteredEvents(normalizedEvents);\n        setThreatStats(calculateThreatStats(normalizedEvents));\n\n        // Legacy format\n        const legacyThreats = normalizedEvents.map(event => ({\n          ...event,\n          type: event.collection === 'scan_alerts' ? 'scan_detection' : 'deception_engine',\n          platform: event.collection === 'scan_alerts' ? 'Scan_Detection_Engine' : 'Deception_Engine',\n          timestamp: new Date(event.timestamp || Date.now()),\n          source: event.source_ip,\n          target: event.dest_port || event.honeypot_id,\n          status: 'new',\n          message: event.message,\n          alertType: event.note_type || event.event_type\n        }));\n\n        setThreats(legacyThreats);\n      }\n    } catch (error) {\n      console.error('Error loading threats:', error);\n    } finally {\n      setLoading(false);\n      setLastUpdated(new Date());\n    }\n  }, [timeRange]);\n\n  useEffect(() => {\n    loadThreats();\n  }, [timeRange, selectedClient]);\n\n  // Handle tab changes from URL\n  useEffect(() => {\n    const path = location.pathname;\n    if (path.includes('/alerts')) setActiveTab('alerts');\n    else if (path.includes('/iocs')) setActiveTab('iocs');\n    else if (path.includes('/ttps')) setActiveTab('ttps');\n    else if (path.includes('/campaigns')) setActiveTab('campaigns');\n  }, [location.pathname]);\n\n  const handleTabChange = (tab) => {\n    setActiveTab(tab);\n    navigate(`/threats/${tab}`);\n  };\n\n  const handleFilterChange = (newFilters) => {\n    setFilters({ ...filters, ...newFilters });\n  };\n\n  const applyFilters = (items) => {\n    return items.filter(item => {\n      if (filters.severity !== 'all' && item.severity !== filters.severity) return false;\n      if (filters.platform !== 'all' && item.platform !== filters.platform) return false;\n      if (filters.status !== 'all' && item.status !== filters.status) return false;\n      if (filters.search) {\n        const search = filters.search.toLowerCase();\n        return (\n          (item.source && item.source.toLowerCase().includes(search)) ||\n          (item.target && item.target.toLowerCase().includes(search)) ||\n          (item.message && item.message.toLowerCase().includes(search)) ||\n          (item.alertType && item.alertType.toLowerCase().includes(search))\n        );\n      }\n      return true;\n    });\n  };\n\n  const filteredThreats = applyFilters(threats);\n\n  const handleThreatClick = (threat) => {\n    navigate(`/threats/alerts/${threat.id}`);\n  };\n\n  const handleExport = () => {\n    try {\n      const dataToExport = useEnhancedFilters ? filteredEvents : applyFilters(threats);\n      const csvContent = exportEventsToCSV(dataToExport);\n      \n      // Create and download CSV file\n      const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\n      const link = document.createElement('a');\n      const url = URL.createObjectURL(blob);\n      link.setAttribute('href', url);\n      link.setAttribute('download', `threats_export_${new Date().toISOString().slice(0, 10)}.csv`);\n      link.style.visibility = 'hidden';\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n    } catch (error) {\n      console.error('Error exporting threats:', error);\n    }\n  };\n\n  // Enhanced filter change handler\n  const handleEnhancedFilterChange = useCallback((filtered) => {\n    setFilteredEvents(filtered);\n  }, []);\n\n  const handleSaveView = (name) => {\n    setSavedViews([...savedViews, { name, filters: { ...filters } }]);\n  };\n\n  const handleLoadView = (view) => {\n    setFilters({ ...filters, ...view.filters });\n  };\n\n  return (\n    <div className=\"threats-page\">\n      <div className=\"page-header\">\n        <div className=\"header-content\">\n          <h1>Threat Intelligence</h1>\n          <p>Monitor, analyze, and respond to security threats</p>\n        </div>\n        <div className=\"header-actions\">\n          <button \n            className={`btn ${useEnhancedFilters ? 'btn-primary' : 'btn-secondary'}`}\n            onClick={() => setUseEnhancedFilters(!useEnhancedFilters)}\n          >\n            ðŸ”§ {useEnhancedFilters ? 'Enhanced' : 'Basic'} Filters\n          </button>\n          <button className=\"btn btn-secondary\" onClick={handleExport}>\n            ðŸ“Š Export ({useEnhancedFilters ? filteredEvents.length : applyFilters(threats).length})\n          </button>\n          <button className=\"btn btn-primary\" onClick={loadThreats}>\n            ðŸ”„ Refresh\n          </button>\n        </div>\n      </div>\n\n      <ThreatTabs activeTab={activeTab} onTabChange={handleTabChange} />\n\n      <div className=\"threats-content\">\n        {useEnhancedFilters ? (\n          <EnhancedFilters\n            events={allEvents}\n            onFilterChange={handleEnhancedFilterChange}\n            loading={loading}\n            className=\"threats-enhanced-filters\"\n          />\n        ) : (\n          <ThreatFilters\n            filters={filters}\n            onFilterChange={handleFilterChange}\n            savedViews={savedViews}\n            onSaveView={handleSaveView}\n            onLoadView={handleLoadView}\n            resultCount={filteredThreats.length}\n          />\n        )}\n\n        <div className=\"threats-main\">\n          {activeTab === 'alerts' && (\n            <ThreatTable\n              threats={useEnhancedFilters ? filteredEvents.map(event => ({\n                ...event,\n                id: event.id || `event-${Math.random()}`,\n                type: event.collection === 'scan_alerts' ? 'scan_detection' : 'deception_engine',\n                platform: event.collection === 'scan_alerts' ? 'Scan_Detection_Engine' : 'Deception_Engine',\n                severity: event.severity || 'medium',\n                timestamp: new Date(event.timestamp || Date.now()),\n                source: event.source_ip,\n                target: event.dest_port || event.honeypot_id,\n                status: 'new',\n                message: event.message,\n                alertType: event.note_type || event.event_type\n              })) : filteredThreats}\n              loading={loading}\n              onThreatClick={handleThreatClick}\n            />\n          )}\n          \n          {activeTab === 'iocs' && (\n            <div className=\"tab-content\">\n              <h3>IOC Analysis</h3>\n              <p>Indicators of Compromise extracted from threat data</p>\n            </div>\n          )}\n          \n          {activeTab === 'ttps' && (\n            <div className=\"tab-content\">\n              <h3>TTP Analysis</h3>\n              <p>Tactics, Techniques, and Procedures identified</p>\n            </div>\n          )}\n          \n          {activeTab === 'campaigns' && (\n            <div className=\"tab-content\">\n              <h3>Campaign Analysis</h3>\n              <p>Correlated attack campaigns and threat actors</p>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Threats;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}